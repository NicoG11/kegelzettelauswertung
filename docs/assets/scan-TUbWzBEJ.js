import{u as Re,b as Ie,a as se,f as $e,l as je,g as Ne}from"./VWindowItem-NKBYbgfh.js";import{aP as De,r as X,c as me,G as Me,aD as Pe,a3 as te,a4 as ie,a5 as T,l as L,ad as x,a6 as W,a9 as J,a8 as we,a7 as Be,ab as le,aa as ye,U as ce,aK as ze,aQ as Fe}from"./index-AogYpwoB.js";import{a as be,V as Ge,b as Ue,c as ue,d as We,e as ne,f as Ve,g as Ye}from"./VStepper-rsCjGyQ-.js";const Ke=De("app",{state:()=>({cameraAccess:!1}),actions:{setCameraAccess(n){this.cameraAccess=n}}});function He(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Je={exports:{}};(function(n){var l=function(u){var h=Object.prototype,C=h.hasOwnProperty,E=Object.defineProperty||function(e,t,o){e[t]=o.value},w,m=typeof Symbol=="function"?Symbol:{},R=m.iterator||"@@iterator",j=m.asyncIterator||"@@asyncIterator",P=m.toStringTag||"@@toStringTag";function y(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{y({},"")}catch{y=function(t,o,g){return t[o]=g}}function $(e,t,o,g){var r=t&&t.prototype instanceof q?t:q,i=Object.create(r.prototype),b=new v(g||[]);return E(i,"_invoke",{value:s(e,o,b)}),i}u.wrap=$;function B(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(g){return{type:"throw",arg:g}}}var G="suspendedStart",N="suspendedYield",D="executing",M="completed",_={};function q(){}function V(){}function O(){}var Y={};y(Y,R,function(){return this});var Z=Object.getPrototypeOf,z=Z&&Z(Z(d([])));z&&z!==h&&C.call(z,R)&&(Y=z);var U=O.prototype=q.prototype=Object.create(Y);V.prototype=O,E(U,"constructor",{value:O,configurable:!0}),E(O,"constructor",{value:V,configurable:!0}),V.displayName=y(O,P,"GeneratorFunction");function Q(e){["next","throw","return"].forEach(function(t){y(e,t,function(o){return this._invoke(t,o)})})}u.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return t?t===V||(t.displayName||t.name)==="GeneratorFunction":!1},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,O):(e.__proto__=O,y(e,P,"GeneratorFunction")),e.prototype=Object.create(U),e},u.awrap=function(e){return{__await:e}};function a(e,t){function o(i,b,k,S){var A=B(e[i],e,b);if(A.type==="throw")S(A.arg);else{var oe=A.arg,K=oe.value;return K&&typeof K=="object"&&C.call(K,"__await")?t.resolve(K.__await).then(function(H){o("next",H,k,S)},function(H){o("throw",H,k,S)}):t.resolve(K).then(function(H){oe.value=H,k(oe)},function(H){return o("throw",H,k,S)})}}var g;function r(i,b){function k(){return new t(function(S,A){o(i,b,S,A)})}return g=g?g.then(k,k):k()}E(this,"_invoke",{value:r})}Q(a.prototype),y(a.prototype,j,function(){return this}),u.AsyncIterator=a,u.async=function(e,t,o,g,r){r===void 0&&(r=Promise);var i=new a($(e,t,o,g),r);return u.isGeneratorFunction(t)?i:i.next().then(function(b){return b.done?b.value:i.next()})};function s(e,t,o){var g=G;return function(i,b){if(g===D)throw new Error("Generator is already running");if(g===M){if(i==="throw")throw b;return I()}for(o.method=i,o.arg=b;;){var k=o.delegate;if(k){var S=c(k,o);if(S){if(S===_)continue;return S}}if(o.method==="next")o.sent=o._sent=o.arg;else if(o.method==="throw"){if(g===G)throw g=M,o.arg;o.dispatchException(o.arg)}else o.method==="return"&&o.abrupt("return",o.arg);g=D;var A=B(e,t,o);if(A.type==="normal"){if(g=o.done?M:N,A.arg===_)continue;return{value:A.arg,done:o.done}}else A.type==="throw"&&(g=M,o.method="throw",o.arg=A.arg)}}}function c(e,t){var o=t.method,g=e.iterator[o];if(g===w)return t.delegate=null,o==="throw"&&e.iterator.return&&(t.method="return",t.arg=w,c(e,t),t.method==="throw")||o!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),_;var r=B(g,e.iterator,t.arg);if(r.type==="throw")return t.method="throw",t.arg=r.arg,t.delegate=null,_;var i=r.arg;if(!i)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,_;if(i.done)t[e.resultName]=i.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=w);else return i;return t.delegate=null,_}Q(U),y(U,P,"Generator"),y(U,R,function(){return this}),y(U,"toString",function(){return"[object Generator]"});function p(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function f(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function v(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(p,this),this.reset(!0)}u.keys=function(e){var t=Object(e),o=[];for(var g in t)o.push(g);return o.reverse(),function r(){for(;o.length;){var i=o.pop();if(i in t)return r.value=i,r.done=!1,r}return r.done=!0,r}};function d(e){if(e){var t=e[R];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,g=function r(){for(;++o<e.length;)if(C.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=w,r.done=!0,r};return g.next=g}}return{next:I}}u.values=d;function I(){return{value:w,done:!0}}return v.prototype={constructor:v,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=w,this.done=!1,this.delegate=null,this.method="next",this.arg=w,this.tryEntries.forEach(f),!e)for(var t in this)t.charAt(0)==="t"&&C.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=w)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(S,A){return i.type="throw",i.arg=e,t.next=S,A&&(t.method="next",t.arg=w),!!A}for(var g=this.tryEntries.length-1;g>=0;--g){var r=this.tryEntries[g],i=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var b=C.call(r,"catchLoc"),k=C.call(r,"finallyLoc");if(b&&k){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(b){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else if(k){if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var g=this.tryEntries[o];if(g.tryLoc<=this.prev&&C.call(g,"finallyLoc")&&this.prev<g.finallyLoc){var r=g;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var i=r?r.completion:{};return i.type=e,i.arg=t,r?(this.method="next",this.next=r.finallyLoc,_):this.complete(i)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),f(o),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var g=o.completion;if(g.type==="throw"){var r=g.arg;f(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:d(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=w),_}},u}(n.exports);try{regeneratorRuntime=l}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=l:Function("r","regeneratorRuntime = r")(l)}})(Je);var ve=(n,l)=>`${n}-${l}-${Math.random().toString(16).slice(3,8)}`;const qe=ve;let ke=0;var Ae=({id:n,action:l,payload:u={}})=>{let h=n;return typeof h>"u"&&(h=qe("Job",ke),ke+=1),{id:h,action:l,payload:u}},re={};let ge=!1;re.logging=ge;re.setLogging=n=>{ge=n};re.log=(...n)=>ge?console.log.apply(void 0,n):null;const Ze=Ae,{log:ae}=re,Xe=ve;let _e=0;var Qe=()=>{const n=Xe("Scheduler",_e),l={},u={};let h=[];_e+=1;const C=()=>h.length,E=()=>Object.keys(l).length,w=()=>{if(h.length!==0){const y=Object.keys(l);for(let $=0;$<y.length;$+=1)if(typeof u[y[$]]>"u"){h[0](l[y[$]]);break}}},m=(y,$)=>new Promise((B,G)=>{const N=Ze({action:y,payload:$});h.push(async D=>{h.shift(),u[D.id]=N;try{B(await D[y].apply(void 0,[...$,N.id]))}catch(M){G(M)}finally{delete u[D.id],w()}}),ae(`[${n}]: Add ${N.id} to JobQueue`),ae(`[${n}]: JobQueue length=${h.length}`),w()});return{addWorker:y=>(l[y.id]=y,ae(`[${n}]: Add ${y.id}`),ae(`[${n}]: Number of workers=${E()}`),w(),y.id),addJob:async(y,...$)=>{if(E()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return m(y,$)},terminate:async()=>{Object.keys(l).forEach(async y=>{await l[y].terminate()}),h=[]},getQueueLen:C,getNumWorkers:E}};function xe(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function et(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var tt=et;const rt=tt;var ot=n=>{const l={};return typeof WorkerGlobalScope<"u"?l.type="webworker":rt()?l.type="electron":typeof document=="object"?l.type="browser":typeof process=="object"&&typeof xe=="function"&&(l.type="node"),typeof n>"u"?l:l[n]};const nt=ot("type")==="browser",at=nt?n=>new URL(n,window.location.href).href:n=>n;var st=n=>{const l={...n};return["corePath","workerPath","langPath"].forEach(u=>{n[u]&&(l[u]=at(l[u]))}),l},it=n=>{const l=[],u=[],h=[],C=[],E=[];return n.blocks&&n.blocks.forEach(w=>{w.paragraphs.forEach(m=>{m.lines.forEach(R=>{R.words.forEach(j=>{j.symbols.forEach(P=>{E.push({...P,page:n,block:w,paragraph:m,line:R,word:j})}),C.push({...j,page:n,block:w,paragraph:m,line:R})}),h.push({...R,page:n,block:w,paragraph:m})}),u.push({...m,page:n,block:w})}),l.push({...w,page:n})}),{...n,blocks:l,paragraphs:u,lines:h,words:C,symbols:E}},Te={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const lt="tesseract.js",ct="5.0.4",ut="Pure Javascript Multilingual OCR",dt="src/index.js",ft="src/index.d.ts",ht="dist/tesseract.min.js",pt="dist/tesseract.min.js",vt={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},gt={"./src/worker/node/index.js":"./src/worker/browser/index.js"},mt="",wt=["jeromewu"],yt="Apache-2.0",bt={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},kt={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^5.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},_t={"@rollup/pluginutils":"^5.0.2"},St={type:"git",url:"https://github.com/naptha/tesseract.js.git"},Lt={url:"https://github.com/naptha/tesseract.js/issues"},Et="https://github.com/naptha/tesseract.js",At={type:"opencollective",url:"https://opencollective.com/tesseractjs"},Tt={name:lt,version:ct,description:ut,main:dt,types:ft,unpkg:ht,jsdelivr:pt,scripts:vt,browser:gt,author:mt,contributors:wt,license:yt,devDependencies:bt,dependencies:kt,overrides:_t,repository:St,bugs:Lt,homepage:Et,collective:At};var Ct={workerBlobURL:!0,logger:()=>{}};const Ot=Tt.version,Rt=Ct;var It={...Rt,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ot}/dist/worker.min.js`},$t=({workerPath:n,workerBlobURL:l})=>{let u;if(Blob&&URL&&l){const h=new Blob([`importScripts("${n}");`],{type:"application/javascript"});u=new Worker(URL.createObjectURL(h))}else u=new Worker(n);return u},jt=n=>{n.terminate()},Nt=(n,l)=>{n.onmessage=({data:u})=>{l(u)}},Dt=async(n,l)=>{n.postMessage(l)};const de=n=>new Promise((l,u)=>{const h=new FileReader;h.onload=()=>{l(h.result)},h.onerror=({target:{error:{code:C}}})=>{u(Error(`File could not be read! Code=${C}`))},h.readAsArrayBuffer(n)}),pe=async n=>{let l=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?l=atob(n.split(",")[1]).split("").map(u=>u.charCodeAt(0)):l=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(l=await pe(n.src)),n.tagName==="VIDEO"&&(l=await pe(n.poster)),n.tagName==="CANVAS"&&await new Promise(u=>{n.toBlob(async h=>{l=await de(h),u()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const u=await n.convertToBlob();l=await de(u)}else(n instanceof File||n instanceof Blob)&&(l=await de(n));return new Uint8Array(l)};var Mt=pe;const Pt=It,Bt=$t,zt=jt,Ft=Nt,Gt=Dt,Ut=Mt;var Wt={defaultOptions:Pt,spawnWorker:Bt,terminateWorker:zt,onMessage:Ft,send:Gt,loadImage:Ut};const Vt=st,Yt=it,F=Ae,{log:Se}=re,Kt=ve,ee=Te,{defaultOptions:Ht,spawnWorker:Jt,terminateWorker:qt,onMessage:Zt,loadImage:Le,send:Xt}=Wt;let Ee=0;var Ce=async(n="eng",l=ee.LSTM_ONLY,u={},h={})=>{const C=Kt("Worker",Ee),{logger:E,errorHandler:w,...m}=Vt({...Ht,...u}),R={},j={},P=typeof n=="string"?n.split("+"):n;let y=l,$=h;const B=[ee.DEFAULT,ee.LSTM_ONLY].includes(l)&&!m.legacyCore;let G,N;const D=new Promise((r,i)=>{N=r,G=i}),M=r=>{G(r.message)};let _=Jt(m);_.onerror=M,Ee+=1;const q=(r,i)=>{R[r]=i},V=(r,i)=>{j[r]=i},O=({id:r,action:i,payload:b})=>new Promise((k,S)=>{Se(`[${C}]: Start ${r}, action=${i}`),q(i,k),V(i,S),Xt(_,{workerId:C,jobId:r,action:i,payload:b})}),Y=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),Z=r=>O(F({id:r,action:"load",payload:{options:{lstmOnly:B,corePath:m.corePath,logging:m.logging}}})),z=(r,i,b)=>O(F({id:b,action:"FS",payload:{method:"writeFile",args:[r,i]}})),U=(r,i)=>O(F({id:i,action:"FS",payload:{method:"readFile",args:[r,{encoding:"utf8"}]}})),Q=(r,i)=>O(F({id:i,action:"FS",payload:{method:"unlink",args:[r]}})),a=(r,i,b)=>O(F({id:b,action:"FS",payload:{method:r,args:i}})),s=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),c=(r,i)=>O(F({id:i,action:"loadLanguage",payload:{langs:r,options:{langPath:m.langPath,dataPath:m.dataPath,cachePath:m.cachePath,cacheMethod:m.cacheMethod,gzip:m.gzip,lstmOnly:[ee.LSTM_ONLY,ee.TESSERACT_LSTM_COMBINED].includes(y)&&!m.legacyLang}}})),p=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),f=(r,i,b,k)=>O(F({id:k,action:"initialize",payload:{langs:r,oem:i,config:b}})),v=(r="eng",i,b,k)=>{if(B&&[ee.TESSERACT_ONLY,ee.TESSERACT_LSTM_COMBINED].includes(i))throw Error("Legacy model requested but code missing.");const S=i||y;y=S;const A=b||$;$=A;const K=(typeof r=="string"?r.split("+"):r).filter(H=>!P.includes(H));return P.push(...K),K.length>0?c(K,k).then(()=>f(r,S,A,k)):f(r,S,A,k)},d=(r={},i)=>O(F({id:i,action:"setParameters",payload:{params:r}})),I=async(r,i={},b={blocks:!0,text:!0,hocr:!0,tsv:!0},k)=>O(F({id:k,action:"recognize",payload:{image:await Le(r),options:i,output:b}})),e=(r="Tesseract OCR Result",i=!1,b)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),O(F({id:b,action:"getPDF",payload:{title:r,textonly:i}}))),t=async(r,i)=>{if(B)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return O(F({id:i,action:"detect",payload:{image:await Le(r)}}))},o=async()=>(_!==null&&(qt(_),_=null),Promise.resolve());Zt(_,({workerId:r,jobId:i,status:b,action:k,data:S})=>{if(b==="resolve"){Se(`[${r}]: Complete ${i}`);let A=S;k==="recognize"?A=Yt(S):k==="getPDF"&&(A=Array.from({...S,length:Object.keys(S).length})),R[k]({jobId:i,data:A})}else if(b==="reject")if(j[k](S),k==="load"&&G(S),w)w(S);else throw Error(S);else b==="progress"&&E({...S,userJobId:i})});const g={id:C,worker:_,setResolve:q,setReject:V,load:Y,writeText:z,readText:U,removeFile:Q,FS:a,loadLanguage:s,initialize:p,reinitialize:v,setParameters:d,recognize:I,getPDF:e,detect:t,terminate:o};return Z().then(()=>c(n)).then(()=>f(n,l,h)).then(()=>N(g)).catch(()=>{}),D};const Oe=Ce,Qt=async(n,l,u)=>{const h=await Oe(l,1,u);return h.recognize(n).finally(async()=>{await h.terminate()})},xt=async(n,l)=>{const u=await Oe("osd",0,l);return u.detect(n).finally(async()=>{await u.terminate()})};var er={recognize:Qt,detect:xt},tr={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},rr={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const or=Qe,nr=Ce,ar=er,sr=tr,ir=Te,lr=rr,{setLogging:cr}=re;var ur={languages:sr,OEM:ir,PSM:lr,createScheduler:or,createWorker:nr,setLogging:cr,...ar};const dr=He(ur),fr={class:"text-h5 pt-2 text-center font-weight-light"},hr=J("div",{class:"text-h5 text-center font-weight-light"},[W('Für Fotoaufnahmen brauchen wir die "Kamera-Berechtigung".'),J("br"),W("Bitte Kamera aktivieren.")],-1),pr={class:"text-center my-4"},vr=["onMousedown","onMousemove","onMouseup","onTouchstart","onTouchmove","onTouchend"],gr={class:"d-felx flex-column text-center"},mr=["onChange"],wr=J("h4",null,"Berechnungen",-1),fe=380,he=600,_r={__name:"scan",setup(n){const l=Re(),u=Ke(),h=X(1),C=X("Lang"),E=X(null),w=X(null),m=X([]),R=X([]),j=X([]),P=X([]);function y(a,s){a&&(m.value[s]=a)}function $(a,s){a&&(P.value[s]=a)}function B(a){P.value[a]&&P.value[a].click()}const G=(a,s)=>{a.preventDefault();const c=a.target.files[0];if(c){const p=new FileReader;p.onload=f=>{const v=new Image;v.onload=()=>{let d=v.width,I=v.height;d>I?d>fe&&(I*=fe/d,d=fe):I>he&&(d*=he/I,I=he);const e=m.value[s],t=e.getContext("2d");e.width=d,e.height=I,t.drawImage(v,0,0,d,I),e.onmousedown=o=>N(s,o),e.onmousemove=o=>D(s,o),e.onmouseup=o=>M(s,o),e.ontouchstart=o=>N(s,o),e.ontouchmove=o=>D(s,o),e.ontouchend=o=>M(s,o),R.value[s]=new Image,R.value[s].src=e.toDataURL("image/png"),m.value[s].replaceWith(e),m.value[s]=e,j.value[s]=null,a.target.value=""},v.src=f.target.result},p.readAsDataURL(c)}},N=(a,s)=>{s.preventDefault();const c=j.value[a];if(c!=null&&c.isDrawing)return;const p=s.touches?s.touches[0].clientX:s.clientX,f=s.touches?s.touches[0].clientY:s.clientY,v=m.value[a].getBoundingClientRect();j.value[a]={x1:p-v.left,y1:f-v.top,x2:p-v.left,y2:f-v.top,isDrawing:!0}},D=(a,s)=>{s.preventDefault();const c=j.value[a];if(!c||!c.isDrawing)return;const p=s.touches?s.touches[0].clientX:s.clientX,f=s.touches?s.touches[0].clientY:s.clientY,v=m.value[a].getBoundingClientRect();c.x2=p-v.left,c.y2=f-v.top;const d=m.value[a].getContext("2d");d.clearRect(0,0,m.value[a].width,m.value[a].height),R.value[a]&&d.drawImage(R.value[a],0,0),d.beginPath(),d.strokeStyle="red",d.rect(c.x1,c.y1,c.x2-c.x1,c.y2-c.y1),d.stroke()},M=(a,s)=>{s.preventDefault();const c=j.value[a];if(c&&c.isDrawing){const p=m.value[a];p.getContext("2d");const f=c.x2-c.x1,v=c.y2-c.y1,d=document.createElement("canvas");d.width=f,d.height=v,d.getContext("2d").drawImage(p,c.x1,c.y1,f,v,0,0,f,v),m.value[a].replaceWith(d),m.value[a]=d,c.isDrawing=!1,Y(d,a)}},_=me(()=>C.value==="Lang"?4:1),q=me(()=>h.value===1?"prev":h.value===3+_.value?"next":void 0);Me(h,async(a,s)=>{var c,p;a>2&&u.cameraAccess&&!E.value?(E.value=await navigator.mediaDevices.getUserMedia({video:!0}),w.value.srcObject=E.value):a<2&&E.value?((c=E.value)==null||c.getTracks().forEach(f=>f.stop()),E.value=null):a===3+_.value&&((p=E.value)==null||p.getTracks().forEach(f=>f.stop()),E.value=null,w.value=null,V())});const V=async()=>{Q();for(let a=0;a<m.value.length;a++)await Y(m.value[a],a)};function O(a){const s=a.getContext("2d"),c=s.getImageData(0,0,a.width,a.height),p=c.data;for(let f=0;f<p.length;f+=4){const d=(.299*p[f]+.587*p[f+1]+.114*p[f+2]-128)*1.8+128;p[f]=p[f+1]=p[f+2]=d}s.putImageData(c,0,0)}const Y=async(a,s)=>{var p,f;const c=a||m.value[s];if(c)try{O(c);const v=c.toDataURL(),I=(f=(p=(await dr.recognize(v,"eng",{tessedit_char_whitelist:"0123456789",tessedit_pageseg_mode:4})).data)==null?void 0:p.text)==null?void 0:f.split(`
`);I[I.length-1]===""&&I.pop(),console.info("Ergebnis:",I),alert(I.join(", "))}catch(v){console.error("Fehler bei der Texterkennung:",v)}},Z=a=>{C.value=a,z()},z=async()=>{h.value<2+_.value&&h.value++},U=async()=>{if(u.cameraAccess)z();else try{await navigator.mediaDevices.getUserMedia({video:!0}),u.setCameraAccess(!0),z()}catch(a){alert("Fehler beim Zugriff auf die Kamera:",a),u.setCameraAccess(!1)}},Q=async a=>{const s=m.value[a];if(w.value&&s){const c=s.getContext("2d");s.width=w.value.videoWidth,s.height=w.value.videoHeight,c.drawImage(w.value,0,0,s.width,s.height),s.onmousedown=p=>N(a,p),s.onmousemove=p=>D(a,p),s.onmouseup=p=>M(a,p),s.ontouchstart=p=>N(a,p),s.ontouchmove=p=>D(a,p),s.ontouchend=p=>M(a,p),R.value[a]=new Image,R.value[a].src=s.toDataURL("image/png"),j.value[a]=null}};return Pe(()=>{u.cameraAccess&&z()}),(a,s)=>(te(),ie(Ie,{class:"fill-height"},{default:T(()=>[L(Ge,{class:"mb-4"},{default:T(()=>[L(be,{cols:"2"},{default:T(()=>[L(x,{onClick:s[0]||(s[0]=c=>a.$router.push({path:"/"}))},{default:T(()=>[W("Zurück")]),_:1})]),_:1}),L(be,null,{default:T(()=>{var c;return[J("div",fr,"Auswertung für "+we((c=Be(l).selectedPlayer)==null?void 0:c.name),1)]}),_:1})]),_:1}),L(Ye,{modelValue:h.value,"onUpdate:modelValue":s[3]||(s[3]=c=>h.value=c)},{default:T(({prev:c,next:p})=>[L(Ue,null,{default:T(()=>[L(ue,{complete:h.value>1,title:"Kamera aktivieren",value:1},null,8,["complete"]),L(se),(te(!0),le(ce,null,ye(_.value,f=>(te(),le(ce,{key:`bahn-${f}`},[L(ue,{complete:h.value>f+2,title:`Bahn ${f}`,value:f+2},null,8,["complete","title","value"]),f!==_.value?(te(),ie(se,{key:0})):Fe("",!0)],64))),128)),L(se),L(ue,{complete:h.value>_.value+3,title:"Berechnung",value:_.value+3},null,8,["complete","value"])]),_:1}),L(We,null,{default:T(()=>[L(ne,{value:1},{default:T(()=>[L(ze,{class:"fill-height"},{default:T(()=>[hr,J("div",pr,[L(x,{onClick:U},{default:T(()=>[W("Kamera aktivieren")]),_:1})])]),_:1})]),_:1}),L(ne,{value:2},{default:T(()=>[L(x,{onClick:s[1]||(s[1]=f=>Z("DIN_A4"))},{default:T(()=>[W("DIN A4")]),_:1}),L(x,{onClick:s[2]||(s[2]=f=>Z("Lang"))},{default:T(()=>[W("Lang")]),_:1})]),_:1}),(te(!0),le(ce,null,ye(_.value,(f,v)=>(te(),ie(ne,{key:`bahn-content-${f}`,value:f+2},{default:T(()=>[L($e,null,{default:T(()=>[L(je,null,{default:T(()=>[W("Bahn "+we(f)+" einlesen",1)]),_:2},1024),L(Ne,null,{default:T(()=>[J("canvas",{ref_for:!0,ref:d=>y(d,v),onMousedown:d=>N(v,d),onMousemove:d=>D(v,d),onMouseup:d=>M(v,d),onTouchstart:d=>N(v,d),onTouchmove:d=>D(v,d),onTouchend:d=>M(v,d)},null,40,vr)]),_:2},1024),J("div",gr,[L(x,{class:"my-1",onClick:d=>Q(v)},{default:T(()=>[W("Zettel Aufnehmen")]),_:2},1032,["onClick"]),L(x,{class:"my-1",onClick:d=>Y(null,v)},{default:T(()=>[W("erkenne zahlen")]),_:2},1032,["onClick"]),L(x,{class:"my-1",onClick:d=>B(v)},{default:T(()=>[W("Zettel von Device laden")]),_:2},1032,["onClick"]),J("input",{type:"file",ref_for:!0,ref:d=>$(d,v),hidden:"",onChange:d=>G(d,v),accept:"image/*"},null,40,mr)])]),_:2},1024)]),_:2},1032,["value"]))),128)),L(ne,{value:_.value+3},{default:T(()=>[wr]),_:1},8,["value"])]),_:1}),L(Ve,{disabled:q.value,color:"green","onClick:prev":c,"onClick:next":p,"next-text":"weiter","prev-text":"zurück"},null,8,["disabled","onClick:prev","onClick:next"])]),_:1},8,["modelValue"]),J("video",{ref_key:"videoElement",ref:w,autoplay:""},null,512)]),_:1}))}};export{_r as default};

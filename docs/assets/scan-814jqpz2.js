import{u as Re,b as $e,a as le,f as Ie,l as je,g as Ne}from"./VWindowItem-eZgevPG3.js";import{aR as Me,r as Q,c as me,G as Pe,aF as De,a3 as ne,a4 as ce,a5 as O,l as L,ad as ee,a6 as W,a9 as H,a8 as we,a7 as Be,ab as ue,aa as ye,U as fe,aM as Fe,af as ze}from"./index-pDqav9Oi.js";import{a as be,V as Ge,b as Ue,c as de,d as We,e as se,f as Ve,g as Ye}from"./VStepper-pVC6-YJb.js";const Ke=Me("app",{state:()=>({cameraAccess:!1}),actions:{setCameraAccess(n){this.cameraAccess=n}}});function He(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Je={exports:{}};(function(n){var l=function(u){var d=Object.prototype,R=d.hasOwnProperty,C=Object.defineProperty||function(e,t,o){e[t]=o.value},w,v=typeof Symbol=="function"?Symbol:{},$=v.iterator||"@@iterator",j=v.asyncIterator||"@@asyncIterator",D=v.toStringTag||"@@toStringTag";function y(e,t,o){return Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{y({},"")}catch{y=function(t,o,p){return t[o]=p}}function I(e,t,o,p){var r=t&&t.prototype instanceof J?t:J,s=Object.create(r.prototype),b=new c(p||[]);return C(s,"_invoke",{value:f(e,o,b)}),s}u.wrap=I;function B(e,t,o){try{return{type:"normal",arg:e.call(t,o)}}catch(p){return{type:"throw",arg:p}}}var G="suspendedStart",N="suspendedYield",M="executing",P="completed",k={};function J(){}function V(){}function T(){}var q={};y(q,$,function(){return this});var U=Object.getPrototypeOf,Z=U&&U(U(E([])));Z&&Z!==d&&R.call(Z,$)&&(q=Z);var F=T.prototype=J.prototype=Object.create(q);V.prototype=T,C(F,"constructor",{value:T,configurable:!0}),C(T,"constructor",{value:V,configurable:!0}),V.displayName=y(T,D,"GeneratorFunction");function i(e){["next","throw","return"].forEach(function(t){y(e,t,function(o){return this._invoke(t,o)})})}u.isGeneratorFunction=function(e){var t=typeof e=="function"&&e.constructor;return t?t===V||(t.displayName||t.name)==="GeneratorFunction":!1},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,y(e,D,"GeneratorFunction")),e.prototype=Object.create(F),e},u.awrap=function(e){return{__await:e}};function a(e,t){function o(s,b,_,S){var A=B(e[s],e,b);if(A.type==="throw")S(A.arg);else{var X=A.arg,Y=X.value;return Y&&typeof Y=="object"&&R.call(Y,"__await")?t.resolve(Y.__await).then(function(K){o("next",K,_,S)},function(K){o("throw",K,_,S)}):t.resolve(Y).then(function(K){X.value=K,_(X)},function(K){return o("throw",K,_,S)})}}var p;function r(s,b){function _(){return new t(function(S,A){o(s,b,S,A)})}return p=p?p.then(_,_):_()}C(this,"_invoke",{value:r})}i(a.prototype),y(a.prototype,j,function(){return this}),u.AsyncIterator=a,u.async=function(e,t,o,p,r){r===void 0&&(r=Promise);var s=new a(I(e,t,o,p),r);return u.isGeneratorFunction(t)?s:s.next().then(function(b){return b.done?b.value:s.next()})};function f(e,t,o){var p=G;return function(s,b){if(p===M)throw new Error("Generator is already running");if(p===P){if(s==="throw")throw b;return x()}for(o.method=s,o.arg=b;;){var _=o.delegate;if(_){var S=g(_,o);if(S){if(S===k)continue;return S}}if(o.method==="next")o.sent=o._sent=o.arg;else if(o.method==="throw"){if(p===G)throw p=P,o.arg;o.dispatchException(o.arg)}else o.method==="return"&&o.abrupt("return",o.arg);p=M;var A=B(e,t,o);if(A.type==="normal"){if(p=o.done?P:N,A.arg===k)continue;return{value:A.arg,done:o.done}}else A.type==="throw"&&(p=P,o.method="throw",o.arg=A.arg)}}}function g(e,t){var o=t.method,p=e.iterator[o];if(p===w)return t.delegate=null,o==="throw"&&e.iterator.return&&(t.method="return",t.arg=w,g(e,t),t.method==="throw")||o!=="return"&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+o+"' method")),k;var r=B(p,e.iterator,t.arg);if(r.type==="throw")return t.method="throw",t.arg=r.arg,t.delegate=null,k;var s=r.arg;if(!s)return t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,k;if(s.done)t[e.resultName]=s.value,t.next=e.nextLoc,t.method!=="return"&&(t.method="next",t.arg=w);else return s;return t.delegate=null,k}i(F),y(F,D,"Generator"),y(F,$,function(){return this}),y(F,"toString",function(){return"[object Generator]"});function m(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function h(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function c(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(m,this),this.reset(!0)}u.keys=function(e){var t=Object(e),o=[];for(var p in t)o.push(p);return o.reverse(),function r(){for(;o.length;){var s=o.pop();if(s in t)return r.value=s,r.done=!1,r}return r.done=!0,r}};function E(e){if(e){var t=e[$];if(t)return t.call(e);if(typeof e.next=="function")return e;if(!isNaN(e.length)){var o=-1,p=function r(){for(;++o<e.length;)if(R.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=w,r.done=!0,r};return p.next=p}}return{next:x}}u.values=E;function x(){return{value:w,done:!0}}return c.prototype={constructor:c,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=w,this.done=!1,this.delegate=null,this.method="next",this.arg=w,this.tryEntries.forEach(h),!e)for(var t in this)t.charAt(0)==="t"&&R.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=w)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if(t.type==="throw")throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(S,A){return s.type="throw",s.arg=e,t.next=S,A&&(t.method="next",t.arg=w),!!A}for(var p=this.tryEntries.length-1;p>=0;--p){var r=this.tryEntries[p],s=r.completion;if(r.tryLoc==="root")return o("end");if(r.tryLoc<=this.prev){var b=R.call(r,"catchLoc"),_=R.call(r,"finallyLoc");if(b&&_){if(this.prev<r.catchLoc)return o(r.catchLoc,!0);if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else if(b){if(this.prev<r.catchLoc)return o(r.catchLoc,!0)}else if(_){if(this.prev<r.finallyLoc)return o(r.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var p=this.tryEntries[o];if(p.tryLoc<=this.prev&&R.call(p,"finallyLoc")&&this.prev<p.finallyLoc){var r=p;break}}r&&(e==="break"||e==="continue")&&r.tryLoc<=t&&t<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=e,s.arg=t,r?(this.method="next",this.next=r.finallyLoc,k):this.complete(s)},complete:function(e,t){if(e.type==="throw")throw e.arg;return e.type==="break"||e.type==="continue"?this.next=e.arg:e.type==="return"?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):e.type==="normal"&&t&&(this.next=t),k},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.finallyLoc===e)return this.complete(o.completion,o.afterLoc),h(o),k}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc===e){var p=o.completion;if(p.type==="throw"){var r=p.arg;h(o)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,o){return this.delegate={iterator:E(e),resultName:t,nextLoc:o},this.method==="next"&&(this.arg=w),k}},u}(n.exports);try{regeneratorRuntime=l}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=l:Function("r","regeneratorRuntime = r")(l)}})(Je);var ve=(n,l)=>`${n}-${l}-${Math.random().toString(16).slice(3,8)}`;const qe=ve;let ke=0;var Ae=({id:n,action:l,payload:u={}})=>{let d=n;return typeof d>"u"&&(d=qe("Job",ke),ke+=1),{id:d,action:l,payload:u}},ae={};let ge=!1;ae.logging=ge;ae.setLogging=n=>{ge=n};ae.log=(...n)=>ge?console.log.apply(void 0,n):null;const Ze=Ae,{log:ie}=ae,Xe=ve;let _e=0;var Qe=()=>{const n=Xe("Scheduler",_e),l={},u={};let d=[];_e+=1;const R=()=>d.length,C=()=>Object.keys(l).length,w=()=>{if(d.length!==0){const y=Object.keys(l);for(let I=0;I<y.length;I+=1)if(typeof u[y[I]]>"u"){d[0](l[y[I]]);break}}},v=(y,I)=>new Promise((B,G)=>{const N=Ze({action:y,payload:I});d.push(async M=>{d.shift(),u[M.id]=N;try{B(await M[y].apply(void 0,[...I,N.id]))}catch(P){G(P)}finally{delete u[M.id],w()}}),ie(`[${n}]: Add ${N.id} to JobQueue`),ie(`[${n}]: JobQueue length=${d.length}`),w()});return{addWorker:y=>(l[y.id]=y,ie(`[${n}]: Add ${y.id}`),ie(`[${n}]: Number of workers=${C()}`),w(),y.id),addJob:async(y,...I)=>{if(C()===0)throw Error(`[${n}]: You need to have at least one worker before adding jobs`);return v(y,I)},terminate:async()=>{Object.keys(l).forEach(async y=>{await l[y].terminate()}),d=[]},getQueueLen:R,getNumWorkers:C}};function xe(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function et(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}var tt=et;const rt=tt;var ot=n=>{const l={};return typeof WorkerGlobalScope<"u"?l.type="webworker":rt()?l.type="electron":typeof document=="object"?l.type="browser":typeof process=="object"&&typeof xe=="function"&&(l.type="node"),typeof n>"u"?l:l[n]};const nt=ot("type")==="browser",at=nt?n=>new URL(n,window.location.href).href:n=>n;var st=n=>{const l={...n};return["corePath","workerPath","langPath"].forEach(u=>{n[u]&&(l[u]=at(l[u]))}),l},it=n=>{const l=[],u=[],d=[],R=[],C=[];return n.blocks&&n.blocks.forEach(w=>{w.paragraphs.forEach(v=>{v.lines.forEach($=>{$.words.forEach(j=>{j.symbols.forEach(D=>{C.push({...D,page:n,block:w,paragraph:v,line:$,word:j})}),R.push({...j,page:n,block:w,paragraph:v,line:$})}),d.push({...$,page:n,block:w,paragraph:v})}),u.push({...v,page:n,block:w})}),l.push({...w,page:n})}),{...n,blocks:l,paragraphs:u,lines:d,words:R,symbols:C}},Te={TESSERACT_ONLY:0,LSTM_ONLY:1,TESSERACT_LSTM_COMBINED:2,DEFAULT:3};const lt="tesseract.js",ct="5.0.5",ut="Pure Javascript Multilingual OCR",ft="src/index.js",dt="src/index.d.ts",ht="dist/tesseract.min.js",pt="dist/tesseract.min.js",vt={start:"node scripts/server.js",build:"rimraf dist && webpack --config scripts/webpack.config.prod.js && rollup -c scripts/rollup.esm.mjs","profile:tesseract":"webpack-bundle-analyzer dist/tesseract-stats.json","profile:worker":"webpack-bundle-analyzer dist/worker-stats.json",prepublishOnly:"npm run build",wait:"rimraf dist && wait-on http://localhost:3000/dist/tesseract.min.js",test:"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:* test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser-tpl":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:detect":"npm run test:browser-tpl -- -f ./tests/detect.test.html","test:browser:recognize":"npm run test:browser-tpl -- -f ./tests/recognize.test.html","test:browser:scheduler":"npm run test:browser-tpl -- -f ./tests/scheduler.test.html","test:browser:FS":"npm run test:browser-tpl -- -f ./tests/FS.test.html",lint:"eslint src","lint:fix":"eslint --fix src",postinstall:"opencollective-postinstall || true"},gt={"./src/worker/node/index.js":"./src/worker/browser/index.js"},mt="",wt=["jeromewu"],yt="Apache-2.0",bt={"@babel/core":"^7.21.4","@babel/eslint-parser":"^7.21.3","@babel/preset-env":"^7.21.4","@rollup/plugin-commonjs":"^24.1.0",acorn:"^8.8.2","babel-loader":"^9.1.2",buffer:"^6.0.3",cors:"^2.8.5",eslint:"^7.32.0","eslint-config-airbnb-base":"^14.2.1","eslint-plugin-import":"^2.27.5","expect.js":"^0.3.1",express:"^4.18.2",mocha:"^10.2.0","mocha-headless-chrome":"^4.0.0","npm-run-all":"^4.1.5",nyc:"^15.1.0",rimraf:"^5.0.0",rollup:"^3.20.7","wait-on":"^7.0.1",webpack:"^5.79.0","webpack-bundle-analyzer":"^4.8.0","webpack-cli":"^5.0.1","webpack-dev-middleware":"^6.0.2","rollup-plugin-sourcemaps":"^0.6.3"},kt={"bmp-js":"^0.1.0","idb-keyval":"^6.2.0","is-electron":"^2.2.2","is-url":"^1.2.4","node-fetch":"^2.6.9","opencollective-postinstall":"^2.0.3","regenerator-runtime":"^0.13.3","tesseract.js-core":"^5.0.0","wasm-feature-detect":"^1.2.11",zlibjs:"^0.3.1"},_t={"@rollup/pluginutils":"^5.0.2"},St={type:"git",url:"https://github.com/naptha/tesseract.js.git"},Lt={url:"https://github.com/naptha/tesseract.js/issues"},Et="https://github.com/naptha/tesseract.js",At={type:"opencollective",url:"https://opencollective.com/tesseractjs"},Tt={name:lt,version:ct,description:ut,main:ft,types:dt,unpkg:ht,jsdelivr:pt,scripts:vt,browser:gt,author:mt,contributors:wt,license:yt,devDependencies:bt,dependencies:kt,overrides:_t,repository:St,bugs:Lt,homepage:Et,collective:At};var Ct={workerBlobURL:!0,logger:()=>{}};const Ot=Tt.version,Rt=Ct;var $t={...Rt,workerPath:`https://cdn.jsdelivr.net/npm/tesseract.js@v${Ot}/dist/worker.min.js`},It=({workerPath:n,workerBlobURL:l})=>{let u;if(Blob&&URL&&l){const d=new Blob([`importScripts("${n}");`],{type:"application/javascript"});u=new Worker(URL.createObjectURL(d))}else u=new Worker(n);return u},jt=n=>{n.terminate()},Nt=(n,l)=>{n.onmessage=({data:u})=>{l(u)}},Mt=async(n,l)=>{n.postMessage(l)};const he=n=>new Promise((l,u)=>{const d=new FileReader;d.onload=()=>{l(d.result)},d.onerror=({target:{error:{code:R}}})=>{u(Error(`File could not be read! Code=${R}`))},d.readAsArrayBuffer(n)}),pe=async n=>{let l=n;if(typeof n>"u")return"undefined";if(typeof n=="string")/data:image\/([a-zA-Z]*);base64,([^"]*)/.test(n)?l=atob(n.split(",")[1]).split("").map(u=>u.charCodeAt(0)):l=await(await fetch(n)).arrayBuffer();else if(typeof HTMLElement<"u"&&n instanceof HTMLElement)n.tagName==="IMG"&&(l=await pe(n.src)),n.tagName==="VIDEO"&&(l=await pe(n.poster)),n.tagName==="CANVAS"&&await new Promise(u=>{n.toBlob(async d=>{l=await he(d),u()})});else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas){const u=await n.convertToBlob();l=await he(u)}else(n instanceof File||n instanceof Blob)&&(l=await he(n));return new Uint8Array(l)};var Pt=pe;const Dt=$t,Bt=It,Ft=jt,zt=Nt,Gt=Mt,Ut=Pt;var Wt={defaultOptions:Dt,spawnWorker:Bt,terminateWorker:Ft,onMessage:zt,send:Gt,loadImage:Ut};const Vt=st,Yt=it,z=Ae,{log:Se}=ae,Kt=ve,te=Te,{defaultOptions:Ht,spawnWorker:Jt,terminateWorker:qt,onMessage:Zt,loadImage:Le,send:Xt}=Wt;let Ee=0;var Ce=async(n="eng",l=te.LSTM_ONLY,u={},d={})=>{const R=Kt("Worker",Ee),{logger:C,errorHandler:w,...v}=Vt({...Ht,...u}),$={},j={},D=typeof n=="string"?n.split("+"):n;let y=l,I=d;const B=[te.DEFAULT,te.LSTM_ONLY].includes(l)&&!v.legacyCore;let G,N;const M=new Promise((r,s)=>{N=r,G=s}),P=r=>{G(r.message)};let k=Jt(v);k.onerror=P,Ee+=1;const J=(r,s)=>{$[r]=s},V=(r,s)=>{j[r]=s},T=({id:r,action:s,payload:b})=>new Promise((_,S)=>{Se(`[${R}]: Start ${r}, action=${s}`);const A=`${s}-${r}`;J(A,_),V(A,S),Xt(k,{workerId:R,jobId:r,action:s,payload:b})}),q=()=>console.warn("`load` is depreciated and should be removed from code (workers now come pre-loaded)"),U=r=>T(z({id:r,action:"load",payload:{options:{lstmOnly:B,corePath:v.corePath,logging:v.logging}}})),Z=(r,s,b)=>T(z({id:b,action:"FS",payload:{method:"writeFile",args:[r,s]}})),F=(r,s)=>T(z({id:s,action:"FS",payload:{method:"readFile",args:[r,{encoding:"utf8"}]}})),i=(r,s)=>T(z({id:s,action:"FS",payload:{method:"unlink",args:[r]}})),a=(r,s,b)=>T(z({id:b,action:"FS",payload:{method:r,args:s}})),f=()=>console.warn("`loadLanguage` is depreciated and should be removed from code (workers now come with language pre-loaded)"),g=(r,s)=>T(z({id:s,action:"loadLanguage",payload:{langs:r,options:{langPath:v.langPath,dataPath:v.dataPath,cachePath:v.cachePath,cacheMethod:v.cacheMethod,gzip:v.gzip,lstmOnly:[te.LSTM_ONLY,te.TESSERACT_LSTM_COMBINED].includes(y)&&!v.legacyLang}}})),m=()=>console.warn("`initialize` is depreciated and should be removed from code (workers now come pre-initialized)"),h=(r,s,b,_)=>T(z({id:_,action:"initialize",payload:{langs:r,oem:s,config:b}})),c=(r="eng",s,b,_)=>{if(B&&[te.TESSERACT_ONLY,te.TESSERACT_LSTM_COMBINED].includes(s))throw Error("Legacy model requested but code missing.");const S=s||y;y=S;const A=b||I;I=A;const Y=(typeof r=="string"?r.split("+"):r).filter(K=>!D.includes(K));return D.push(...Y),Y.length>0?g(Y,_).then(()=>h(r,S,A,_)):h(r,S,A,_)},E=(r={},s)=>T(z({id:s,action:"setParameters",payload:{params:r}})),x=async(r,s={},b={blocks:!0,text:!0,hocr:!0,tsv:!0},_)=>T(z({id:_,action:"recognize",payload:{image:await Le(r),options:s,output:b}})),e=(r="Tesseract OCR Result",s=!1,b)=>(console.log("`getPDF` function is depreciated. `recognize` option `savePDF` should be used instead."),T(z({id:b,action:"getPDF",payload:{title:r,textonly:s}}))),t=async(r,s)=>{if(B)throw Error("`worker.detect` requires Legacy model, which was not loaded.");return T(z({id:s,action:"detect",payload:{image:await Le(r)}}))},o=async()=>(k!==null&&(qt(k),k=null),Promise.resolve());Zt(k,({workerId:r,jobId:s,status:b,action:_,data:S})=>{const A=`${_}-${s}`;if(b==="resolve"){Se(`[${r}]: Complete ${s}`);let X=S;_==="recognize"?X=Yt(S):_==="getPDF"&&(X=Array.from({...S,length:Object.keys(S).length})),$[A]({jobId:s,data:X})}else if(b==="reject")if(j[A](S),_==="load"&&G(S),w)w(S);else throw Error(S);else b==="progress"&&C({...S,userJobId:s})});const p={id:R,worker:k,setResolve:J,setReject:V,load:q,writeText:Z,readText:F,removeFile:i,FS:a,loadLanguage:f,initialize:m,reinitialize:c,setParameters:E,recognize:x,getPDF:e,detect:t,terminate:o};return U().then(()=>g(n)).then(()=>h(n,l,d)).then(()=>N(p)).catch(()=>{}),M};const Oe=Ce,Qt=async(n,l,u)=>{const d=await Oe(l,1,u);return d.recognize(n).finally(async()=>{await d.terminate()})},xt=async(n,l)=>{const u=await Oe("osd",0,l);return u.detect(n).finally(async()=>{await u.terminate()})};var er={recognize:Qt,detect:xt},tr={AFR:"afr",AMH:"amh",ARA:"ara",ASM:"asm",AZE:"aze",AZE_CYRL:"aze_cyrl",BEL:"bel",BEN:"ben",BOD:"bod",BOS:"bos",BUL:"bul",CAT:"cat",CEB:"ceb",CES:"ces",CHI_SIM:"chi_sim",CHI_TRA:"chi_tra",CHR:"chr",CYM:"cym",DAN:"dan",DEU:"deu",DZO:"dzo",ELL:"ell",ENG:"eng",ENM:"enm",EPO:"epo",EST:"est",EUS:"eus",FAS:"fas",FIN:"fin",FRA:"fra",FRK:"frk",FRM:"frm",GLE:"gle",GLG:"glg",GRC:"grc",GUJ:"guj",HAT:"hat",HEB:"heb",HIN:"hin",HRV:"hrv",HUN:"hun",IKU:"iku",IND:"ind",ISL:"isl",ITA:"ita",ITA_OLD:"ita_old",JAV:"jav",JPN:"jpn",KAN:"kan",KAT:"kat",KAT_OLD:"kat_old",KAZ:"kaz",KHM:"khm",KIR:"kir",KOR:"kor",KUR:"kur",LAO:"lao",LAT:"lat",LAV:"lav",LIT:"lit",MAL:"mal",MAR:"mar",MKD:"mkd",MLT:"mlt",MSA:"msa",MYA:"mya",NEP:"nep",NLD:"nld",NOR:"nor",ORI:"ori",PAN:"pan",POL:"pol",POR:"por",PUS:"pus",RON:"ron",RUS:"rus",SAN:"san",SIN:"sin",SLK:"slk",SLV:"slv",SPA:"spa",SPA_OLD:"spa_old",SQI:"sqi",SRP:"srp",SRP_LATN:"srp_latn",SWA:"swa",SWE:"swe",SYR:"syr",TAM:"tam",TEL:"tel",TGK:"tgk",TGL:"tgl",THA:"tha",TIR:"tir",TUR:"tur",UIG:"uig",UKR:"ukr",URD:"urd",UZB:"uzb",UZB_CYRL:"uzb_cyrl",VIE:"vie",YID:"yid"},rr={OSD_ONLY:"0",AUTO_OSD:"1",AUTO_ONLY:"2",AUTO:"3",SINGLE_COLUMN:"4",SINGLE_BLOCK_VERT_TEXT:"5",SINGLE_BLOCK:"6",SINGLE_LINE:"7",SINGLE_WORD:"8",CIRCLE_WORD:"9",SINGLE_CHAR:"10",SPARSE_TEXT:"11",SPARSE_TEXT_OSD:"12",RAW_LINE:"13"};const or=Qe,nr=Ce,ar=er,sr=tr,ir=Te,lr=rr,{setLogging:cr}=ae;var ur={languages:sr,OEM:ir,PSM:lr,createScheduler:or,createWorker:nr,setLogging:cr,...ar};const fr=He(ur),dr={class:"text-h5 pt-2 text-center font-weight-light"},hr=H("div",{class:"text-h5 text-center font-weight-light"},[W('Für Fotoaufnahmen brauchen wir die "Kamera-Berechtigung".'),H("br"),W("Bitte Kamera aktivieren.")],-1),pr={class:"text-center my-4"},vr=["onMousedown","onMousemove","onMouseup","onTouchstart","onTouchmove","onTouchend"],gr={class:"d-felx flex-column text-center"},mr=["onChange"],wr=H("h4",null,"Berechnungen",-1),re=380,oe=600,_r={__name:"scan",setup(n){const l=Re(),u=Ke(),d=Q(1),R=Q("Lang"),C=Q(null),w=Q(null),v=Q([]),$=Q([]),j=Q([]),D=Q([]);function y(i,a){i&&(v.value[a]=i)}function I(i,a){i&&(D.value[a]=i)}function B(i){D.value[i]&&D.value[i].click()}const G=(i,a)=>{i.preventDefault();const f=i.target.files[0];if(f){const g=new FileReader;g.onload=m=>{const h=new Image;h.onload=()=>{let c=h.width,E=h.height;c>E?c>re&&(E*=re/c,c=re):E>oe&&(c*=oe/E,E=oe);const x=c/E;(c>re||E>oe)&&(c/E>re/oe?(E=Math.round(re/x),c=re):(c=Math.round(oe*x),E=oe));const e=v.value[a],t=e.getContext("2d");e.width=c,e.height=E,t.drawImage(h,0,0,c,E),e.onmousedown=o=>N(a,o),e.onmousemove=o=>M(a,o),e.onmouseup=o=>P(a,o),e.ontouchstart=o=>N(a,o),e.ontouchmove=o=>M(a,o),e.ontouchend=o=>P(a,o),$.value[a]=new Image,$.value[a].src=e.toDataURL("image/png"),v.value[a].replaceWith(e),v.value[a]=e,j.value[a]=null,i.target.value=""},h.src=m.target.result},g.readAsDataURL(f)}},N=(i,a)=>{a.preventDefault();const f=j.value[i];if(f!=null&&f.isDrawing)return;const g=a.touches?a.touches[0].clientX:a.clientX,m=a.touches?a.touches[0].clientY:a.clientY,h=v.value[i].getBoundingClientRect();j.value[i]={x1:g-h.left,y1:m-h.top,x2:g-h.left,y2:m-h.top,isDrawing:!0}},M=(i,a)=>{a.preventDefault();const f=j.value[i];if(!f||!f.isDrawing)return;const g=a.touches?a.touches[0].clientX:a.clientX,m=a.touches?a.touches[0].clientY:a.clientY,h=v.value[i].getBoundingClientRect();f.x2=g-h.left,f.y2=m-h.top;const c=v.value[i].getContext("2d");c.clearRect(0,0,v.value[i].width,v.value[i].height),$.value[i]&&c.drawImage($.value[i],0,0),c.beginPath(),c.strokeStyle="red",c.rect(f.x1,f.y1,f.x2-f.x1,f.y2-f.y1),c.stroke()},P=(i,a)=>{a.preventDefault();const f=j.value[i];if(f&&f.isDrawing){const g=v.value[i];g.getContext("2d");const m=f.x2-f.x1,h=f.y2-f.y1,c=document.createElement("canvas");c.width=m,c.height=h,c.getContext("2d").drawImage(g,f.x1,f.y1,m,h,0,0,m,h),v.value[i].replaceWith(c),v.value[i]=c,f.isDrawing=!1,T(c,i)}},k=me(()=>R.value==="Lang"?4:1),J=me(()=>d.value===1?"prev":d.value===3+k.value?"next":void 0);Pe(d,async(i,a)=>{var f,g;i>2&&u.cameraAccess&&!C.value?(C.value=await navigator.mediaDevices.getUserMedia({video:!0}),w.value.srcObject=C.value):i<2&&C.value?((f=C.value)==null||f.getTracks().forEach(m=>m.stop()),C.value=null):i===3+k.value&&((g=C.value)==null||g.getTracks().forEach(m=>m.stop()),C.value=null,w.value=null,V())});const V=async()=>{F();for(let i=0;i<v.value.length;i++)await T(v.value[i],i)},T=async(i,a)=>{var g,m;const f=i||v.value[a];if(f)try{const h=f.toDataURL(),E=(m=(g=(await fr.recognize(h,"eng",{tessedit_char_whitelist:"0123456789",tessedit_pageseg_mode:4})).data)==null?void 0:g.text)==null?void 0:m.split(`
`);E[E.length-1]===""&&E.pop(),console.info("Ergebnis:",E),alert(E.join(", "))}catch(h){console.error("Fehler bei der Texterkennung:",h)}},q=i=>{R.value=i,U()},U=async()=>{d.value<2+k.value&&d.value++},Z=async()=>{if(u.cameraAccess)U();else try{await navigator.mediaDevices.getUserMedia({video:!0}),u.setCameraAccess(!0),U()}catch(i){alert("Fehler beim Zugriff auf die Kamera:",i),u.setCameraAccess(!1)}},F=async i=>{const a=v.value[i];if(w.value&&a){const f=a.getContext("2d");a.width=w.value.videoWidth,a.height=w.value.videoHeight,f.drawImage(w.value,0,0,a.width,a.height),a.onmousedown=g=>N(i,g),a.onmousemove=g=>M(i,g),a.onmouseup=g=>P(i,g),a.ontouchstart=g=>N(i,g),a.ontouchmove=g=>M(i,g),a.ontouchend=g=>P(i,g),$.value[i]=new Image,$.value[i].src=a.toDataURL("image/png"),j.value[i]=null}};return De(()=>{u.cameraAccess&&U()}),(i,a)=>(ne(),ce($e,{class:"fill-height"},{default:O(()=>[L(Ge,{class:"mb-4"},{default:O(()=>[L(be,{cols:"2"},{default:O(()=>[L(ee,{onClick:a[0]||(a[0]=f=>i.$router.push({path:"/"}))},{default:O(()=>[W("Zurück")]),_:1})]),_:1}),L(be,null,{default:O(()=>{var f;return[H("div",dr,"Auswertung für "+we((f=Be(l).selectedPlayer)==null?void 0:f.name),1)]}),_:1})]),_:1}),L(Ye,{modelValue:d.value,"onUpdate:modelValue":a[3]||(a[3]=f=>d.value=f)},{default:O(({prev:f,next:g})=>[L(Ue,null,{default:O(()=>[L(de,{complete:d.value>1,title:"Kamera aktivieren",value:1},null,8,["complete"]),L(le),(ne(!0),ue(fe,null,ye(k.value,m=>(ne(),ue(fe,{key:`bahn-${m}`},[L(de,{complete:d.value>m+2,title:`Bahn ${m}`,value:m+2},null,8,["complete","title","value"]),m!==k.value?(ne(),ce(le,{key:0})):ze("",!0)],64))),128)),L(le),L(de,{complete:d.value>k.value+3,title:"Berechnung",value:k.value+3},null,8,["complete","value"])]),_:1}),L(We,null,{default:O(()=>[L(se,{value:1},{default:O(()=>[L(Fe,{class:"fill-height"},{default:O(()=>[hr,H("div",pr,[L(ee,{onClick:Z},{default:O(()=>[W("Kamera aktivieren")]),_:1})])]),_:1})]),_:1}),L(se,{value:2},{default:O(()=>[L(ee,{onClick:a[1]||(a[1]=m=>q("DIN_A4"))},{default:O(()=>[W("DIN A4")]),_:1}),L(ee,{onClick:a[2]||(a[2]=m=>q("Lang"))},{default:O(()=>[W("Lang")]),_:1})]),_:1}),(ne(!0),ue(fe,null,ye(k.value,(m,h)=>(ne(),ce(se,{key:`bahn-content-${m}`,value:m+2},{default:O(()=>[L(Ie,null,{default:O(()=>[L(je,null,{default:O(()=>[W("Bahn "+we(m)+" einlesen",1)]),_:2},1024),L(Ne,null,{default:O(()=>[H("canvas",{ref_for:!0,ref:c=>y(c,h),onMousedown:c=>N(h,c),onMousemove:c=>M(h,c),onMouseup:c=>P(h,c),onTouchstart:c=>N(h,c),onTouchmove:c=>M(h,c),onTouchend:c=>P(h,c)},null,40,vr)]),_:2},1024),H("div",gr,[L(ee,{class:"my-1",onClick:c=>F(h)},{default:O(()=>[W("Zettel Aufnehmen")]),_:2},1032,["onClick"]),L(ee,{class:"my-1",onClick:c=>T(null,h)},{default:O(()=>[W("erkenne zahlen")]),_:2},1032,["onClick"]),L(ee,{class:"my-1",onClick:c=>B(h)},{default:O(()=>[W("Zettel von Device laden")]),_:2},1032,["onClick"]),H("input",{type:"file",ref_for:!0,ref:c=>I(c,h),hidden:"",onChange:c=>G(c,h),accept:"image/*"},null,40,mr)])]),_:2},1024)]),_:2},1032,["value"]))),128)),L(se,{value:k.value+3},{default:O(()=>[wr]),_:1},8,["value"])]),_:1}),L(Ve,{disabled:J.value,color:"green","onClick:prev":f,"onClick:next":g,"next-text":"weiter","prev-text":"zurück"},null,8,["disabled","onClick:prev","onClick:next"])]),_:1},8,["modelValue"]),H("video",{ref_key:"videoElement",ref:w,autoplay:""},null,512)]),_:1}))}};export{_r as default};
